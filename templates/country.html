{% extends "base.html" %}

{% block title %}{{ country_name }} Dashboard{% endblock %}

{% block content %}
<h2>{{ country_flag }} {{ country_name }}</h2>

{% if errors %}
<div style="color: red;">
    <ul>
        {% for error in errors %}
        <li>{{ error }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<form method='POST' action="{{ url_for('calculate', country_code=country_code) }}" id="income-form">

    {# Hidden input for country if country_name is set #}
    {% if country_name %}
    <input type="hidden" name="country" value="{{ country_code }}">
    {% else %}
    <label for="country">Select Country:</label>
    <select id="country" name="country" required>
        <option value="" disabled selected>Please select a country</option>
        <option value="US">ðŸ‡ºðŸ‡¸ United States</option>
        <option value="AU">ðŸ‡¦ðŸ‡º Australia</option>
        <option value="DE">ðŸ‡©ðŸ‡ª Germany</option>
        <option value="GB">ðŸ‡¬ðŸ‡§ United Kingdom</option>
        <option value="CA">ðŸ‡¨ðŸ‡¦ Canada</option>
    </select>
    <br><br>
    {% endif %}

    <label for="state">Select State/Region:</label>
    <select id="state" name="state" required>
        <option value="" disabled {% if not state %}selected{% endif %}>Please select a state/region</option>
    </select>
    <br><br>

    <div>
        <label for="gross_income">Gross Monthly Income </label>
        <span id="currency-symbol-gross">{{ currency_symbol or '' }}</span>
        <input type="number" id="gross_income" name="gross_income" step="0.01"
               placeholder="Enter Gross Income" value="{{ gross or '' }}" required>
    </div>

    <div>
        <label for="net_income">Net Monthly Income</label>
        <span id="currency-symbol-net">{{ currency_symbol or '' }}</span>
        <input type="number" id="net_income" name="net_income" step="0.01"
               placeholder="Enter Net Income" value="{{ net or '' }}" required>
    </div>
    <br>

    <label for="start_time">Start Time (HH:MM):</label>
    <input type="time" id="start_time" name="start_time" value="{{ start_time or '09:00' }}" required><br>

    <label for="end_time">End Time (HH:MM):</label>
    <input type="time" id="end_time" name="end_time" value="{{ end_time or '17:00' }}" required><br>


    <input type="submit" value="Calculate">

</form>

<!--{% if holidays_this_month %}-->
<!--<h3>Holidays in {{ selected_region }} for {{ current_month }}</h3>-->
<!--<ul>-->
<!--  {% for holiday in holidays_this_month %}-->
<!--  <li>{{ holiday }}</li>-->
<!--  {% endfor %}-->
<!--</ul>-->
<!--{% elif selected_region %}-->
<!--<p>No holidays this month in {{ selected_region }}.</p>-->
<!--{% endif %}-->

<div id="holidays-section">
    <!-- This section will be populated with holidays dynamically -->
    {% if holidays %}
    <h3>Holidays in {{ state or 'Unknown Region' }} for {{ current_month }}</h3>

    <h4> Working Days in {{ current_month }}</h4>
    {% if working_days_current_month|length > 0 %}
    <p>Working days in {{ current_month }}: {{ working_days_current_month|length }}</p>
    {% endif %}

    {% if holidays|length > 0 %}
    <ul>
        {% for holiday in holidays %}
        <li>{{ holiday }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% else %}
    <p>Loading holidays...</p>
    {% endif %}
    <!-- Holidays will appear here dynamically -->
</div>

{% endblock %}